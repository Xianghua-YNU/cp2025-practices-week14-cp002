# 项目1实验报告：Lotka-Volterra捕食者-猎物模型

**学生姓名：** 叶瑞昀  
**学号：** 20231050034 
**完成日期：** 20250528  
**实验时间：** 2h

---

## 1. 实验目的

本实验旨在通过数值方法求解Lotka-Volterra捕食者-猎物模型，掌握以下内容：

- 理解生物种群动力学的数学建模方法
- 学习将高阶常微分方程组转换为一阶方程组的标准形式
- 掌握多种数值方法求解常微分方程组（欧拉法、改进欧拉法、4阶龙格-库塔法）
- 比较不同数值方法的精度和稳定性
- 分析生态系统中捕食者与猎物的相互作用规律

## 2. 理论背景

### 2.1 Lotka-Volterra方程组

请简要描述Lotka-Volterra方程组的数学形式和各参数的生物学意义：

```
Lotka-Volterra方程组的数学形式如下：

dx/dt = αx - βxy  
dy/dt = γxy - δy

其中：
- x：猎物（如兔子）种群数量
- y：捕食者（如狼）种群数量
- α（alpha）：猎物的自然增长率（没有捕食者时的增长速度）
- β（beta）：捕食者捕食猎物的效率（每对捕食-猎物相遇导致猎物减少的速率）
- γ（gamma）：捕食者因捕食猎物而增加的速率（每对捕食-猎物相遇导致捕食者增加的速率）
- δ（delta）：捕食者的自然死亡率（没有猎物时的减少速度）

该方程描述了捕食者和猎物之间的相互作用及其种群数量随时间的变化。
```

### 2.2 数值方法原理

请简要说明您实现的三种数值方法的基本原理：

**欧拉法：**
```
欧拉法是一种最基本的显式数值积分方法。它用当前时刻的导数（斜率）来线性近似下一个时刻的函数值。公式为：
y_{n+1} = y_n + h * f(y_n, t_n)
其中 h 为步长，f(y_n, t_n) 为微分方程在当前点的斜率。
```

**改进欧拉法：**
```
改进欧拉法（又称梯形法或Heun法）在欧拉法的基础上，先用欧拉法预测一个值，再用该预测值计算斜率的平均值，从而提高精度。公式为：
k1 = h * f(y_n, t_n)
k2 = h * f(y_n + k1, t_n + h)
y_{n+1} = y_n + (k1 + k2) / 2
```

**4阶龙格-库塔法：**
```
4阶龙格-库塔法（RK4）通过在每一步内多次采样斜率，并加权平均，极大提高了数值解的精度和稳定性。它综合了当前点、区间中点和终点的斜率信息，常用于科学计算。其公式为：
k1 = h * f(y_n, t_n)
k2 = h * f(y_n + k1/2, t_n + h/2)
k3 = h * f(y_n + k2/2, t_n + h/2)
k4 = h * f(y_n + k3, t_n + h)
y_{n+1} = y_n + (k1 + 2*k2 + 2*k3 + k4) / 6
```

## 3. 实验方法与实现

### 3.1 参数设置

根据题目要求，本实验使用以下参数：

- 模型参数：α = 1.0, β = 0.5, γ = 0.5, δ = 2.0
- 初始条件：x₀ = 2.0, y₀ = 2.0
- 时间范围：t ∈ [0, 30]
- 时间步长：dt = 0.01

### 3.2 核心算法实现

请在此处粘贴您实现的核心函数代码片段（选择最重要的1-2个函数）：

```python
# 例如：lotka_volterra_system函数
# lotka_volterra_system函数
def lotka_volterra_system(state: np.ndarray, t: float, alpha: float, beta: float, 
                          gamma: float, delta: float) -> np.ndarray:
    """
    Lotka-Volterra方程组的右端函数
    参数:
        state: [x, y] 当前状态向量
        t: 时间（本系统中未显式使用）
        alpha, beta, gamma, delta: 模型参数
    返回:
        导数向量 [dx/dt, dy/dt]
    """
    x, y = state
    dxdt = alpha * x - beta * x * y
    dydt = gamma * x * y - delta * y
    return np.array([dxdt, dydt])]
```

```python
# 例如：runge_kutta_4函数
[# runge_kutta_4函数
def runge_kutta_4(f, y0: np.ndarray, t_span: Tuple[float, float], 
                  dt: float, *args) -> Tuple[np.ndarray, np.ndarray]:
    """
    4阶龙格-库塔法求解常微分方程组
    参数:
        f: 微分方程组的右端函数
        y0: 初始条件向量
        t_span: 时间范围 (t_start, t_end)
        dt: 时间步长
        *args: 传递给f的额外参数
    返回:
        t: 时间数组
        y: 解数组，形状为 (len(t), len(y0))
    """
    t_start, t_end = t_span
    t = np.arange(t_start, t_end + dt, dt)
    n_steps = len(t)
    n_vars = len(y0)
    y = np.zeros((n_steps, n_vars))
    y[0] = y0
    for i in range(n_steps - 1):
        h = dt
        yi = y[i]
        ti = t[i]
        k1 = h * f(yi, ti, *args)
        k2 = h * f(yi + k1/2, ti + h/2, *args)
        k3 = h * f(yi + k2/2, ti + h/2, *args)
        k4 = h * f(yi + k3, ti + h, *args)
        y[i+1] = yi + (k1 + 2*k2 + 2*k3 + k4) / 6
    return t, y
```

### 3.3 实现过程中遇到的问题

请描述您在实现过程中遇到的主要问题及解决方法：

```
1. 问题：matplotlib绘图时报错“AttributeError: module 'matplotlib.pyplot' has no attribute 'figure'”。
   解决方法：检查是否有同名文件matplotlib.py导致模块冲突，并确保matplotlib已正确安装。

2. 问题：pip不是内部或外部命令，无法安装依赖包。
   解决方法：使用“python -m pip install 包名”进行安装，或将pip路径添加到环境变量。

3. 问题：数值方法实现初期，欧拉法和改进欧拉法结果不稳定或发散。
   解决方法：检查步长dt设置是否过大，并对算法公式进行逐步调试和验证。

4. 问题：Lotka-Volterra方程参数传递出错，导致结果异常。
   解决方法：统一参数顺序，确保所有函数调用时参数一致，并增加注释说明。

通过上述方法，逐步解决了数值模拟和环境配置中的主要问题，保证了程序的正确运行和结果输出。
```

## 4. 实验结果

### 4.1 基本求解结果

请在此处粘贴使用4阶龙格-库塔法求解得到的种群动力学图：
![population_dynamics](https://github.com/user-attachments/assets/ebc32ce9-464c-43c8-87a6-f4460e77d774)

```

图4.1: Lotka-Volterra种群动力学
左图：种群数量随时间变化；右图：相空间轨迹

```

**观察结果描述：**
```
从左侧的时间序列图可以看到，猎物（Prey）和捕食者（Predator）种群数量均呈现周期性波动，且两者的峰值存在一定的相位差。右侧的相空间轨迹图显示，系统状态在相空间中形成封闭轨道，说明种群数量随时间循环变化，系统表现出典型的周期性动力学行为。
```

### 4.2 数值方法比较

请在此处粘贴三种数值方法的比较图：
![method_comparison](https://github.com/user-attachments/assets/c81de8d3-8841-40b7-96ac-02515c97a127)

```
图4.2: 三种数值方法比较
上排：时间序列比较；下排：相空间比较
```

**比较结果分析：**

| 方法         | 计算精度           | 计算效率      | 稳定性         | 守恒量误差      |
|--------------|-------------------|--------------|---------------|----------------|
| 欧拉法       | 低                | 高           | 差            | 大             |
| 改进欧拉法   | 中                | 中           | 较好          | 中             |
| 4阶RK法      | 高                | 较低         | 很好          | 小             |

请在此处粘贴不同初始条件下的结果图：
![parameter_analysis](https://github.com/user-attachments/assets/e40f8d6e-ef4f-4ee6-a651-7062a8fedbbc)

```
[请粘贴参数分析图]
图4.3: 不同初始条件的影响
```

**参数敏感性分析：**
```
不同初始条件（如不同的猎物和捕食者初始数量）会影响系统在相空间中的轨道形状和振幅，但不会改变系统的周期性本质。具体表现为：

- 各组初始条件下，种群数量随时间的变化曲线均呈现周期性波动，但最大值和最小值不同。
- 相空间轨迹为封闭曲线，轨道的大小和形状取决于初始种群数量，说明系统的能量守恒量与初始状态有关。
- 不同初始条件下，系统不会收敛到同一个轨道，而是围绕不同的能量水平线循环。
- 总体来看，Lotka-Volterra系统对初始条件敏感，但始终保持周期性和守恒特性。
```

## 5. 结果分析与讨论

### 5.1 生物学意义分析

请从生物学角度分析实验结果：

**种群动力学特征：**
```
实验结果显示，猎物和捕食者的数量均呈现周期性波动。猎物数量上升时，捕食者数量随后也会增加；当捕食者数量达到高峰后，由于对猎物的捕食作用，猎物数量开始下降，进而导致捕食者数量也随之减少。随后，猎物数量恢复，周期循环往复。这种周期性变化是Lotka-Volterra模型的典型特征。
```

**相互作用机制：**
```
捕食者与猎物的数量变化存在明显的相位差。通常，猎物数量的峰值出现在捕食者数量峰值之前。原因在于猎物数量增加为捕食者提供了更多食物资源，促进捕食者数量增长；而捕食者数量过多时会导致猎物数量下降，进而捕食者数量也减少。这种相互作用机制导致两者数量的周期性波动和相位关系。
```

**生态平衡：**
```
系统表现出动态的生态平衡。虽然种群数量不断波动，但在参数不变的情况下，系统不会出现种群灭绝或无限增长，而是围绕某一平衡点周期性变化。这种平衡状态反映了自然界中捕食-被捕食关系下的生态稳定性，即在没有外部干扰和资源变化时，捕食者和猎物可以长期共存，维持生态系统的动态平衡。
```


### 5.2 数值方法评估

**精度比较：**
```
4阶Runge-Kutta法（RK4）精度最高，能够很好地保持系统的周期性和守恒量，数值误差最小。改进欧拉法（Heun法）精度次之，误差较小但长期积分时守恒量会有缓慢漂移。欧拉法精度最低，误差较大，容易导致系统发散或守恒量严重偏离。精度的差异主要源于各方法对微分方程近似的阶数不同，RK4为四阶，改进欧拉为二阶，欧拉法为一阶。
```

**计算效率：**
```
欧拉法计算效率最高，单步只需一次函数计算，适合快速粗略模拟。改进欧拉法每步需两次函数计算，效率适中。RK4每步需四次函数计算，计算量最大，但在相同精度要求下可用较大步长，整体效率未必最低。实际应用中，若对精度要求高，RK4更优；对速度要求高且精度要求不高时可选欧拉法。
```

**适用性分析：**
```
当问题对精度和长期稳定性要求较高（如研究守恒量、周期行为等）时，应优先选择4阶Runge-Kutta法。改进欧拉法适合对精度有一定要求但又希望兼顾效率的场合。欧拉法仅适用于教学演示或对精度要求极低的初步探索，不建议用于实际科学计算。对于刚性方程或更复杂系统，还需考虑更高级的自适应或隐式方法。
```

## 6. 思考题

请回答以下思考题：

### 6.1 周期性分析
**问题：** 为什么Lotka-Volterra系统会表现出周期性行为？这种周期性在现实生态系统中是否存在？

**回答：**
```
Lotka-Volterra系统表现出周期性行为，是因为捕食者和猎物之间存在相互依赖和反馈机制：猎物数量增加时，为捕食者提供了更多食物，导致捕食者数量随后增加；而捕食者数量过多时，会加速猎物数量的减少，进而捕食者因食物短缺而减少。随着捕食者数量下降，猎物数量又得以恢复，如此循环往复，形成周期性波动。

在现实生态系统中，类似的周期性现象确实存在。例如，北美的雪兔和猞猁种群数量就呈现出明显的周期性波动。但实际生态系统比Lotka-Volterra模型更复杂，受多种因素影响（如环境变化、疾病、迁徙等），因此周期性可能不如理想模型中那样规则和持久，但周期性动力学依然是许多生态系统的重要特征之一。
```



**实验报告完成情况自评：**

- [√] 完成了所有必需的函数实现
- [√] 通过了所有测试用例
- [√] 生成了所有要求的图表
- [√] 完成了结果分析和讨论
- [√] 回答了所有思考题

**总体评价：** 完美

**建议成绩：** 100 / 100分
